import{j as e,u as $,R as q,r as D,f as R,b as A,c as T}from"./app-db9bbc0b.js";import{A as O,d as N}from"./AuthenticatedLayout-939d80b2.js";import{i as l}from"./import-b490d008.js";import{u as V,a as F}from"./index.esm-b9e81855.js";import{Q as g}from"./react-toastify.esm-bf5a6290.js";import{m as K,b as p}from"./chunk-NXTXE2B3-7c35f28b.js";import{s as L,l as E}from"./chunk-ZFWMN6TD-09f32f54.js";import"./transition-7e5823d5.js";function B({register:o,index:a,handleRemove:u,handlePriceChange:i,getValues:j,handleQuantityChange:h}){return e.jsx("div",{children:e.jsxs("div",{className:" flex dark:text-white justify-between space-x-5 items-center",children:[e.jsxs("div",{className:" flex flex-wrap  w-full   ",children:[e.jsx("div",{className:" flex-1 flex px-2   flex-col  ",children:e.jsx("div",{className:" flex px-2   flex-1  flex-col items-start",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",label:"Description.",labelPlacement:"outside",startContent:"🧮",onChange:c=>h(a,c),...o(`items.${a}.description`)})})}),e.jsx("div",{className:" flex px-2   flex-1  flex-col items-start",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"number",label:"Qty.",labelPlacement:"outside",startContent:"🧮",onChange:c=>h(a,c)})}),e.jsx("div",{className:" flex px-2 flex-1  flex-col items-start",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"number",label:"Rate",labelPlacement:"outside",onChange:c=>i(a,c),startContent:"K"})}),e.jsx("div",{className:" flex px-2 flex-1  flex-col items-start",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"number",className:"bg-white dark:bg-[#1e2139]",isReadOnly:!0,label:"Amount.",labelPlacement:"outside",startContent:"K",bgColor:"white",...o(`items.${a}.amount`)})})]}),e.jsx("button",{className:"pt-8",onClick:()=>{u(a)},children:"🗑️"})]})})}const M=({size:o=24,width:a,height:u,...i})=>e.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:o||u,role:"presentation",viewBox:"0 0 24 24",width:o||a,...i,children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[e.jsx("path",{d:"M6 12h12"}),e.jsx("path",{d:"M12 18V6"})]})});function ee({auth:o}){const a=$(),u=[{description:"",quantity:0,rate:0,amount:0}],i=V({defaultValues:{invoiceNumber:0,client:0,date:new Date().toISOString().slice(0,10),due_date:new Date().toISOString().slice(0,10),truck_plate:"",subtotal:0,invoicetotal:0,items:u}}),{fields:j,append:h,remove:c}=F({control:i.control,name:"items"}),{register:n,reset:y,setValue:d,getValues:r,handleSubmit:Q}=i,w=(t,s)=>{const x=parseInt(s.target.value);d(`items.${t}.rate`,x);const m=r(`items.${t}.quantity`),b=r(`items.${t}.rate`),f=m*b;d(`items.${t}.amount`,f),v()},C=(t,s)=>{const x=parseInt(s.target.value);d(`items.${t}.quantity`,x);const m=r(`items.${t}.quantity`),b=r(`items.${t}.rate`),f=m*b;console.log("total :","qty",m,f),d(`items.${t}.amount`,f),v()},v=()=>{const s=r("items").reduce((m,b)=>m+b.amount,0);d("subtotal",s);const x=r("subtotal")+r("subtotal")*.16;d("invoicetotal",x)},S=t=>{c(t)},I=()=>{h({description:"",quantity:0,rate:0,amount:0,id:""})},[k,W]=q.useState(!1),P=async t=>{console.log(t),T.post("/invoices",t).then(s=>{console.log("res :",s),g.success("Invoice Added Successfully"),y()}).catch(s=>{console.log("err :",s),g.error("Failed to create an Invoice")})};D.useEffect(()=>{a(R())},[a]);const _=A(t=>t.customers.customers);return e.jsx(O,{user:o.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Invoice"}),children:e.jsxs(K.div,{initial:{x:-500,opacity:0},animate:{opacity:1,x:0,transition:{type:"spring",stiffness:300,damping:40,duration:.4}},exit:{x:-700,transition:{duration:.2}},className:"  scrollbar-hide flex flex-col dark:text-white dark:bg-[#141625] bg-white my-5  md:pl-[50px] py-16 px-6 h-screen md:w-full md:rounded-r-3xl",children:[e.jsx("h1",{className:" font-semibold dark:text-white  text-3xl",children:"Create Invoice"}),e.jsxs("form",{className:"overflow-y-scroll relative scrollbar-hide ",onSubmit:i.handleSubmit(P),children:[e.jsx("div",{className:"  ",children:e.jsxs("div",{className:" ",children:[e.jsx("h1",{className:"my-4 mt-5 font-medium",children:"Bill To"}),e.jsx(N,{className:"my-5"}),e.jsxs("div",{className:" grid grid-cols-2   gap-3   ",children:[e.jsx("div",{className:" mx-1 col-span-1 ",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",label:"Invoice No#",labelPlacement:"outside",startContent:"#",className:" ",...n("invoiceNumber")},"invoiceNumber")}),e.jsx("div",{className:"  col-span-1",children:e.jsx(L,{labelPlacement:"outside",label:"Client Name",className:" ",startContent:"👤",...n("client"),children:_.map(t=>e.jsx(E,{value:t.id,children:t.firstname+" "+t.lastname},t.id))})})]}),e.jsxs("div",{className:" flex justify-center space-x-5 items-center mt-8 ",children:[e.jsx("div",{className:" flex-1  ",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"date",label:"Invoice Date",labelPlacement:"outside",startContent:"🗓️",...n("date")},"date")}),e.jsx("div",{className:"flex-1  ",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"date",label:"Due Date",labelPlacement:"outside",startContent:"🗓️",...n("due_date")},"date")})]}),e.jsx("div",{className:" mx-1 mt-6 flex flex-col ",children:e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",label:"Truck Plate Number",labelPlacement:"outside",startContent:"🚚",className:"",...n("truck_plate")},"transport")}),e.jsx("h2",{className:" font-medium text-gray-500 mt-10 ",children:"Item List"}),e.jsx(N,{className:"my-5"}),j.map(({id:t},s)=>e.jsx("div",{className:" border-b pb-2 border-gray-300 mb-4 ",children:e.jsx(B,{handleRemove:S,handlePriceChange:w,getValues:r,control:i.control,handleQuantityChange:C,index:s,name:`items.${s}.name`,register:n},s)},s)),e.jsxs("div",{className:"flex flex-col   items-end",children:[e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",isReadOnly:!0,label:"Sub Total",labelPlacement:"outside",startContent:"K",className:"w-fit float-right",...n("subtotal")},"Sub Total"),e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",value:"16",labelPlacement:"outside",startContent:"%",className:"w-fit my-5 float-right"},"vat"),e.jsx(l,{style:{border:"none",outline:"none",boxShadow:"none"},isReadOnly:!0,type:"text",label:"Invoice Total",labelPlacement:"outside",startContent:"K",className:"w-fit float-right",...n("invoicetotal")},"invoiceTotal"),e.jsx("input",{type:"hidden",...n("issued_by",{value:o.user.id})})]})]})}),e.jsxs("div",{className:"sticky space-y-4",children:[e.jsx(p,{onClick:()=>{I()},className:"  w-full mt-4",color:"primary",endContent:e.jsx(M,{}),children:"Add New Item"}),e.jsxs("div",{className:" flex  justify-between",children:[e.jsx("div",{children:e.jsx(p,{onClick:()=>{y()},className:"  ",color:"primary",children:"Discard"})}),e.jsx("div",{children:e.jsx(p,{className:"  ",color:"primary",type:"submit",isLoading:k,children:"Submit"})})]})]})]})]},"createInvoice-sidebar")})}export{ee as default};
