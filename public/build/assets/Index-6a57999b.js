import{R,u as N,b as L,r as O,f as p,j as e,c as f}from"./app-762d5f89.js";import{A as _,d as v,a as o}from"./AuthenticatedLayout-985a2aa8.js";import{u as w,C as D,c as U,A as F}from"./AddModal-ee2a17d0.js";import"./TextInput-faabcae7.js";import{u as T}from"./index.esm-60c03363.js";import{I as a}from"./InputText-5c1023fe.js";import{b as h}from"./chunk-NXTXE2B3-22c4c1a2.js";import"./methods-82dbbe7c.js";const V=["firstname","tpin","lastname","company_name","contact","address","actions"];function K({auth:j}){const[n,i]=R.useState(null),{register:t,reset:l,setValue:C,handleSubmit:y,getValues:M,formState:b}=T(),m=N(),{customers:g,status:W,error:$}=L(s=>s.customers);O.useEffect(()=>{m(p())},[]);const{isOpen:S,onOpen:x,onOpenChange:u}=w(),A=async s=>{try{n?(await f.put(`/customers/${n}`,s),o.success("Customer Updated Successfully"),l(),i(null)):(await f.post("/customers",s),o.success("Customer Added Successfully")),u(),m(p()),l()}catch(r){console.error("Error:",r),o.error("Failed to Add/Update Customer")}},I=s=>{i(s.id),Object.entries(s).forEach(([r,c])=>{C(r,c)}),x()},E=async s=>{var r,c;try{if(confirm("are you sure you want to delete this Record")){const d=await f.delete(`/customers/${s}`);o.success("Record Deleted"),m(p())}else o.error("Request Cancelled")}catch(d){o("Somthing Went Wrong"),console.error("Error deleting:",((c=(r=d.response)==null?void 0:r.data)==null?void 0:c.error)||d.message)}};return e.jsxs(_,{user:j.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Customers"}),children:[e.jsx(D,{baseurl:"none",editRecord:I,onOpen:x,title:n?"Edit Customer":"Add Customer",handleDelete:E,tableObject:g,tableColumns:U,initialColumns:V}),e.jsx(F,{onOpenChange:u,isOpen:S,title:"Add Customer",isSubmitting:!1,children:e.jsxs("form",{onSubmit:y(A),children:[e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx(a,{style:{border:"none",outline:"none",":focus":{outline:"none"}},title:"Firstname",name:"firstname",register:t}),e.jsx(a,{name:"lastname",register:t,title:"Lastname"}),e.jsx(a,{name:"company_name",register:t,title:"Company Name"}),e.jsx(a,{name:"tpin",register:t,title:"Tpin"}),e.jsx(a,{name:"contact",register:t,title:"Contact"}),e.jsx(a,{name:"address",register:t,title:"Address"})]}),e.jsx(v,{className:"my-5"}),e.jsxs("div",{className:"buttonSection flex  justify-end gap-1",children:[e.jsx(h,{color:"danger",variant:"flat",onPress:()=>{l(),i(null),u()},children:"Close"}),e.jsx(h,{isLoading:b.isSubmitting,type:"submit",color:"primary",children:n?"Update":"Create"})]})]})})]})}export{K as default};
