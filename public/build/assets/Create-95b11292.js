import{j as e,u as C,R as A,r as D,f as E,i as G,b as u,c as p,y as j}from"./app-8f4d3859.js";import{A as I,d as y,a as m}from"./AuthenticatedLayout-7f460c47.js";import{I as l}from"./InputText-9e52dc82.js";import{u as O,a as F}from"./index.esm-646e44cc.js";import{j as B,b as f}from"./chunk-NXTXE2B3-260b1d2b.js";const $=({size:i=24,width:s,height:o,...n})=>e.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:i||o,role:"presentation",viewBox:"0 0 24 24",width:i||s,...n,children:e.jsxs("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,children:[e.jsx("path",{d:"M6 12h12"}),e.jsx("path",{d:"M12 18V6"})]})});function q({register:i,index:s,handleRemove:o,getValues:n}){return e.jsx("div",{children:e.jsxs("div",{className:" flex dark:text-white justify-between space-x-5 items-center",children:[e.jsxs("div",{className:" flex flex-wrap  w-full   ",children:[e.jsx("div",{className:" flex px-2   flex-1  flex-col items-start",children:e.jsx(l,{title:"Order Ref.",name:`items.${s}.order_ref`,register:i,errors:n().items[s].order_ref})}),e.jsx("div",{className:" flex px-2   flex-1  flex-col items-start",children:e.jsx(l,{title:"Quantity",name:`items.${s}.quantity`,register:i,errors:n().items[s].quantity})}),e.jsx("div",{className:" flex-1 flex px-2   flex-col  ",children:e.jsx("div",{className:" flex px-2   flex-1  flex-col items-start",children:e.jsx(l,{title:"Description",name:`items.${s}.description`,register:i,errors:n().items[s].description})})})]}),e.jsx("button",{className:"pt-8",onClick:()=>{o(s)},children:"🗑️"})]})})}function W({auth:i,goodsRecieved:s}){const o=C(),n=[{order_ref:"",description:"",quantity:0}],t=O({defaultValues:{reference:s?s.reference:"",order_ref:s?s.order_reference:"",received_by:s?s.received_by:"",checked_by:s?s.checked_by:"",goods_condition:s?s.goods_condition:"",date:s?s.date:new Date().toISOString().slice(0,10),items:s?JSON.parse(s.items):n}}),{fields:b,append:v,remove:N}=F({control:t.control,name:"items"}),{register:c,reset:h,setValue:L,getValues:S,handleSubmit:J}=t,_=a=>{N(a)},w=()=>{v({order_ref:"",description:"",quantity:0,id:""})},[k,M]=A.useState(!1),g=async a=>{if(s&&s.id){const r=new FormData;Object.entries(a).forEach(([d,x])=>{d==="items"&&Array.isArray(x)?r.append(d,JSON.stringify(x)):r.append(d,x)}),r.append("_method","PUT"),p.post(`/good-received/${s.id}`,r).then(d=>{m.success("Goods Received Edited Successfully"),h(),j.visit("/good-received")}).catch(d=>{console.error("Error editing goods received:",d),m.error("Failed to edit goods received")})}else p.post("/good-received",a).then(r=>{m.success("Goods Received Added Successfully"),j.visit("/good-received")}).catch(r=>{console.error("Error adding goods received:",r),m.error("Failed to add goods received")})};return D.useEffect(()=>{o(E()),o(G())},[o]),u(a=>a.customers.customers),u(a=>a.invoices.invoices),e.jsx(I,{user:i.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:s?"Edit Goods Receievd":"Create Goods Received"}),children:e.jsxs(B.div,{initial:{x:-500,opacity:0},animate:{opacity:1,x:0,transition:{type:"spring",stiffness:300,damping:40,duration:.4}},exit:{x:-700,transition:{duration:.2}},className:"  scrollbar-hide flex flex-col dark:text-white dark:bg-[#141625] bg-white my-5  md:pl-[50px] py-16 px-6 h-screen md:w-full md:rounded-r-3xl",children:[e.jsx("h1",{className:" font-semibold dark:text-white  text-3xl",children:s?"Edit Goods Receievd":"Create Goods Received"}),e.jsxs("form",{className:"overflow-y-scroll relative scrollbar-hide ",onSubmit:t.handleSubmit(g),children:[e.jsx("div",{className:"  ",children:e.jsxs("div",{className:" ",children:[e.jsx(y,{className:"my-5"}),e.jsx("div",{className:" grid grid-cols-2   gap-5   "}),e.jsxs("div",{className:" flex justify-center mb-5 space-x-5 items-center mt-8 ",children:[e.jsx("div",{className:" flex-1  ",children:e.jsx(l,{label:"Reference",name:"reference",register:c,title:"Reference",errors:t.formState.errors})}),e.jsx("div",{className:"flex-1  ",children:e.jsx(l,{label:"Order Reference",name:"order_ref",register:c,title:"Order Reference",errors:t.formState.errors})})]}),e.jsx("div",{className:"flex-1 pt-3  ",children:e.jsx(l,{label:"Date",name:"date",type:"date",register:c,title:"Date",errors:t.formState.errors})}),e.jsxs("div",{className:" flex justify-center mb-5 space-x-5 items-center mt-8 ",children:[e.jsx("div",{className:" flex-1  ",children:e.jsx(l,{label:"Received By",name:"received_by",register:c,title:"Received By",errors:t.formState.errors})}),e.jsx("div",{className:"flex-1  ",children:e.jsx(l,{label:"Checked By",name:"checked_by",register:c,title:"Checked By",errors:t.formState.errors})})]}),e.jsx("div",{className:"flex-1 pt-3  ",children:e.jsx(l,{label:"Goods Condition",name:"goods_condition",register:c,title:"Goods Condition",errors:t.formState.errors})}),e.jsx("h2",{className:" font-medium text-gray-500 mt-10 ",children:"Item List"}),e.jsx(y,{className:"my-5"}),b.map(({id:a},r)=>e.jsx("div",{className:" border-b pb-2 border-gray-300 mb-4 ",children:e.jsx(q,{handleRemove:_,getValues:S,control:t.control,index:r,name:`items.${r}.name`,register:c},r)},r)),e.jsx("div",{className:"flex flex-col   items-end",children:e.jsx("input",{type:"hidden",...c("issued_by",{value:i.user.id})})})]})}),e.jsxs("div",{className:"sticky space-y-4",children:[e.jsx(f,{onClick:()=>{w()},className:"  w-full mt-4",color:"primary",endContent:e.jsx($,{}),children:"Add New Item"}),e.jsxs("div",{className:" flex  justify-between",children:[e.jsx("div",{children:e.jsx(f,{onClick:()=>{h()},className:"  ",color:"primary",children:"Discard"})}),e.jsx("div",{children:e.jsx(f,{className:"  ",color:"primary",type:"submit",isLoading:k,children:"Submit"})})]})]})]})]},"createDeliverynote-sidebar")})}export{W as default};
