import{R as E,u as A,b as O,r as L,k as f,j as e,c as u,l as v}from"./app-014112a5.js";import{A as D,d as _,a as r}from"./AuthenticatedLayout-9299cbe8.js";import{u as V,C as F,n as M,A as T}from"./AddModal-bb4705b1.js";import{u as U}from"./index.esm-c9bca9d9.js";import{I as x}from"./InputText-5b705e7f.js";import{b as h}from"./chunk-NXTXE2B3-b00e3ddd.js";import"./transition-73cd2085.js";import"./methods-82dbbe7c.js";function J({auth:S}){const b=["email"],[a,l]=E.useState(null),{register:d,reset:m,setValue:j,handleSubmit:y,getValues:W,formState:g}=U(),{isOpen:w,onOpen:p,onOpenChange:i}=V(),n=A(),{subscribers:C}=O(t=>t.newsletter);L.useEffect(()=>{n(f())},[n]);const N=async t=>{try{a?(await u.put(`/newsletter/${a}`,t),r.success("Newsletter updated Successfully"),l(null)):(await u.post("/newsletter",t),r.success("Newsletter Sent Successfully")),i(),n(f()),m()}catch(s){console.error("Error:",s),r.error("Failed to Send Newsletter")}},I=t=>{l(t.id),Object.entries(t).forEach(([s,o])=>{j(s,o)}),p()},R=async t=>{var s,o;try{if(confirm("are you sure you want to delete this Record")){const c=await u.delete(`/suppliers/${t}`);r.success("Record Deleted"),n(v())}else r.error("Request Cancelled")}catch(c){r("Somthing Went Wrong"),console.error("Error deleting:",((o=(s=c.response)==null?void 0:s.data)==null?void 0:o.error)||c.message)}};return e.jsxs(D,{user:S.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Send Newsletter"}),children:[e.jsx(F,{onOpen:p,baseurl:"none",editRecord:I,title:"Suppliers",handleDelete:R,tableObject:C,tableColumns:M,initialColumns:b}),e.jsx(T,{onOpenChange:i,isOpen:w,title:"Send Newsletter",isSubmitting:!1,children:e.jsx("form",{onSubmit:y(N),children:e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx(x,{title:"Subject",name:"title",register:d}),e.jsx(x,{type:"textarea",title:"Content",name:"content",register:d}),e.jsx(_,{className:"my-5"}),e.jsxs("div",{className:"buttonSection flex  justify-end gap-1",children:[e.jsx(h,{color:"danger",variant:"flat",onPress:()=>{m(),l(null),i()},children:"Close"}),e.jsx(h,{isLoading:g.isSubmitting,type:"submit",color:"primary",children:a?"Update":"Create"})]})]})})})]})}export{J as default};
