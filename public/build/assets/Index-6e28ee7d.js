import{R as I,u as _,b as j,r as P,l as f,j as e,c as y}from"./app-762d5f89.js";import{A as T,d as L,a as l}from"./AuthenticatedLayout-985a2aa8.js";import{u as U,C as W,f as V,A as $}from"./AddModal-ee2a17d0.js";import{u as M}from"./index.esm-60c03363.js";import{I as r}from"./InputText-5c1023fe.js";import{r as E}from"./methods-82dbbe7c.js";import{b as C}from"./chunk-NXTXE2B3-22c4c1a2.js";const Q=["quantity","price","total","status","duty","actions"];function X({auth:S}){const[c,p]=I.useState(null),{register:o,reset:h,handleSubmit:N,setValue:i,watch:u,getValues:m,formState:q}=M(),w=t=>{p(t.id),Object.entries(t).forEach(([s,n])=>{i(s,n)}),g()},{isOpen:D,onOpen:g,onOpenChange:x}=U(),d=_();j(t=>t.suppliers);const{fuelExpenses:F}=j(t=>t.fuelExpenses);P.useEffect(()=>{d(f())},[d]);const b=()=>{console.log("watch :",u("quantity"));const t=u("quantity"),s=u("price"),n=u("exchange_rate"),a=E(t*s*n,3);i("total",a)},O=()=>{const t=m("quantity"),s=m("price"),n=E(t*s,3);i("total",n),R()},R=()=>{const s=18e4/m("quantity");i("duty",s)},v=async t=>{var s,n;try{if(confirm("are you sure you want to delete this Record")){const a=await y.delete(`/fuel-expenses/${t}`);l.success("Record Deleted"),d(f())}else l.error("Request Cancelled")}catch(a){l("Somthing Went Wrong"),console.error("Error deleting:",((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||a.message)}},A=async t=>{try{if(c){const s=new FormData;Object.entries(t).forEach(([n,a])=>{s.append(n,a)}),s.append("_method","PUT"),await y.put(`/fuel-expenses/${c}`,t),l.success("Fuel Expense Updated Successfully"),p(null)}else await y.post("/fuel-expenses",t),l.success("Fuel Expense Added Successfully");x(),d(f()),h()}catch(s){console.error("Error:",s),l.error("Something Went Wrong")}};return e.jsxs(T,{user:S.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Fuel Expense"}),children:[e.jsx(W,{onOpen:g,editRecord:w,title:"Fuel Expenses",baseurl:"none",handleDelete:v,tableObject:F,tableColumns:V,initialColumns:Q}),e.jsx($,{onOpenChange:x,isOpen:D,title:c?"Edit Fuel Expense":"Add Fuel Expense",isSubmitting:!1,children:e.jsx("form",{onSubmit:N(A),children:e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx(r,{style:{border:"none",outline:"none",":focus":{outline:"none"}},type:"number",title:"Quantity",className:"border-none outline-none  ",register:o,name:"quantity",onChange:O,startContent:e.jsx("span",{className:"text-default-400 text-small"})}),e.jsx(r,{style:{border:"none"},step:".02",pattern:"^\\d*(\\.\\d{0,2})?$",type:"number",title:"Price",placeholder:"",className:"   ",register:o,name:"price",onChange:b}),e.jsx(r,{style:{border:"none"},type:"number",title:"Exchange Rate",placeholder:"",className:"   ",register:o,name:"exchange_rate",onChange:b}),e.jsx("div",{children:e.jsx(r,{title:"Total",readOnly:!0,className:"bg-gray-100 w-full p-2 rounded-xl",register:o,name:"total",startContent:e.jsx("span",{className:"text-default-400 text-small"})})}),e.jsx("div",{children:e.jsx(r,{style:{border:"none"},type:"number",title:"Duty",register:o,name:"duty",readOnly:!0,startContent:e.jsx("span",{className:"text-default-400 text-small"})})}),e.jsxs("select",{labelPlacement:"outside",label:"Status",className:" bg-gray-100 flex-1 mt-1 p-2 rounded-xl w-full border-none outline-none focus:ring-0 ",startContent:"ðŸ‘¤",...o("status",{required:!0}),children:[e.jsx("option",{id:"pending",value:"pending",children:"Pending"},"pending"),e.jsx("option",{id:"paid",value:"paid",children:"Paid"},"paid")]}),e.jsx(L,{className:"my-5"}),e.jsxs("div",{className:"buttonSection flex  justify-end gap-1",children:[e.jsx(C,{color:"danger",variant:"flat",onPress:()=>{p(null),h(),x()},children:"Close"}),e.jsx(C,{isLoading:q.isSubmitting,type:"submit",color:"primary",children:c?"Update":"Create"})]})]})})})]})}export{X as default};
