import{R as A,u as N,b as O,r as _,p as x,j as e,c as h}from"./app-01207e1b.js";import{A as v,d as q,a as r}from"./AuthenticatedLayout-f2d4b46f.js";import{u as w,C as D,t as L,A as W}from"./AddModal-f6ab950c.js";import{u as U}from"./index.esm-e149808e.js";import{r as V}from"./methods-82dbbe7c.js";import{I as c}from"./InputText-979ea0a8.js";import{b}from"./chunk-NXTXE2B3-d4c8c7c7.js";import"./transition-2c4247df.js";const $=["quantity","price","status","actions"];function J({auth:y}){const[l,d]=A.useState(null),{register:o,reset:j,setValue:g,handleSubmit:E,getValues:u,formState:S}=U(),C=t=>{d(t.id),Object.entries(t).forEach(([s,n])=>{g(s,n)}),f()},{isOpen:T,onOpen:f,onOpenChange:p}=w(),i=N(),{transportExpense:I}=O(t=>t.transport);_.useEffect(()=>{i(x())},[i]);const P=async t=>{try{if(l){const s=await h.put(`/transport-expenses/${l}`,t);console.log(s),r.success("Transport Expense Updated Successfully"),d(null)}else await h.post("/transport-expenses",t),r.success("Transport Expense Added Successfully");p(),i(x()),j()}catch(s){console.error("Error:",s),r.error("Something Went Wrong")}},R=async t=>{var s,n;try{if(confirm("are you sure you want to delete this Record")){const a=await h.delete(`/transport-expenses/${t}`);console.log(a),r.success("Record Deleted"),i(x())}else r.error("Request Cancelled")}catch(a){r("Somthing Went Wrong"),console.error("Error deleting:",((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.error)||a.message)}},m=()=>{const t=u("quantity"),s=u("price"),n=u("exchange_rate"),a=V(t*s*n,3);g("total",a)};return e.jsxs(v,{user:y.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Transport Expense"}),children:[e.jsx(D,{onOpen:f,editRecord:C,title:"Transport Expenses",baseurl:"none",tableObject:I,tableColumns:L,initialColumns:$,handleDelete:R}),e.jsx(W,{onOpenChange:p,isOpen:T,title:l?"Edit Transport Expense":"Add Transport Expense",isSubmitting:!1,children:e.jsx("form",{onSubmit:E(P),children:e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx(c,{type:"number",labelPlacement:"outside",title:"Quantity",register:o,name:"quantity",onChange:m}),e.jsx(c,{type:"number",step:".02",pattern:"^\\d*(\\.\\d{0,2})?$",labelPlacement:"outside",title:"Price",register:o,name:"price",onChange:m}),e.jsx(c,{type:"number",labelPlacement:"outside",title:"Exchange Rate",register:o,name:"exchange_rate",onChange:m}),e.jsx(c,{title:"Total",readOnly:!0,register:o,name:"total"}),e.jsxs("select",{labelPlacement:"outside",label:"Status",className:" bg-gray-100 flex-1 mt-1 p-2 rounded-xl w-full border-none outline-none focus:ring-0",startContent:"ðŸ‘¤",...o("status"),children:[e.jsx("option",{id:"pending",value:"pending",children:"Pending"},"pending"),e.jsx("option",{id:"paid",value:"paid",children:"Paid"},"paid")]}),e.jsx(q,{className:"my-5"}),e.jsxs("div",{className:"buttonSection flex  justify-end gap-1",children:[e.jsx(b,{color:"danger",variant:"flat",onPress:()=>{d(null),p()},children:"Close"}),e.jsx(b,{isLoading:S.isSubmitting,type:"submit",color:"primary",children:l?"Update":"Create"})]})]})})})]})}export{J as default};
