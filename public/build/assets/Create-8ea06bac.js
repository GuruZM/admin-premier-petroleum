import{j as e,u as D,R as _,r as I,f as P,e as k,b as m,c as A,y as F}from"./app-62ab0ddb.js";import{A as R,d as x,Q as u}from"./AuthenticatedLayout-cc2080ac.js";import{i as o}from"./chunk-TC4QW7OA-c3fdbe53.js";import{P as V}from"./PlusIcon-0c82abfd.js";import{u as q,a as E}from"./index.esm-cda2f740.js";import{m as $,b as c}from"./chunk-NXTXE2B3-97d82820.js";import{s as h,l as p}from"./chunk-ZFWMN6TD-f8d4464a.js";import"./transition-aa3a03eb.js";import"./import-4334f8a2.js";function L({register:i,index:t,handleRemove:r,getValues:n}){return e.jsx("div",{children:e.jsxs("div",{className:" flex dark:text-white justify-between space-x-5 items-center",children:[e.jsxs("div",{className:" flex flex-wrap  w-full   ",children:[e.jsx("div",{className:" flex-1 flex px-2   flex-col  ",children:e.jsx("div",{className:" flex px-2   flex-1  flex-col items-start",children:e.jsx(o,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",label:"Description.",labelPlacement:"outside",startContent:"🧮",...i(`items.${t}.description`)})})}),e.jsx("div",{className:" flex px-2   flex-1  flex-col items-start",children:e.jsx(o,{style:{border:"none",outline:"none",boxShadow:"none"},type:"number",label:"Qty.",labelPlacement:"outside",startContent:"🧮",...i(`items.${t}.quantity`)})})]}),e.jsx("button",{className:"pt-8",onClick:()=>{r(t)},children:"🗑️"})]})})}function X({auth:i}){const t=D(),r=[{description:"",quantity:0}],n=q({defaultValues:{invoice:0,client:0,date:new Date().toISOString().slice(0,10),issue_date:new Date().toISOString().slice(0,10),number:"",items:r}}),{fields:b,append:f,remove:y}=E({control:n.control,name:"items"}),{register:l,reset:d,setValue:O,getValues:j,handleSubmit:Q}=n,v=s=>{y(s)},N=()=>{f({description:"",quantity:0,id:""})},[g,z]=_.useState(!1),S=async s=>{A.post("/delivery-notes",s).then(a=>{u.success("Delivery Note Added Successfully"),d(),F.visit("/delivery-notes")}).catch(a=>{console.log("err :",a),u.error("Failed to create a Delivery Note")})};I.useEffect(()=>{t(P()),t(k())},[t]);const w=m(s=>s.customers.customers),C=m(s=>s.invoices.invoices);return e.jsx(R,{user:i.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Delivery Notes"}),children:e.jsxs($.div,{initial:{x:-500,opacity:0},animate:{opacity:1,x:0,transition:{type:"spring",stiffness:300,damping:40,duration:.4}},exit:{x:-700,transition:{duration:.2}},className:"  scrollbar-hide flex flex-col dark:text-white dark:bg-[#141625] bg-white my-5  md:pl-[50px] py-16 px-6 h-screen md:w-full md:rounded-r-3xl",children:[e.jsx("h1",{className:" font-semibold dark:text-white  text-3xl",children:"Create Delivery Note"}),e.jsxs("form",{className:"overflow-y-scroll relative scrollbar-hide ",onSubmit:n.handleSubmit(S),children:[e.jsx("div",{className:"  ",children:e.jsxs("div",{className:" ",children:[e.jsx(x,{className:"my-5"}),e.jsxs("div",{className:" grid grid-cols-2   gap-3   ",children:[e.jsx("div",{className:" mx-1 col-span-1",children:e.jsx(h,{labelPlacement:"outside",label:"Select Invoice",className:" ",startContent:"⚅",...l("invoice"),children:C.map(s=>e.jsx(p,{value:s.id,children:s.number},s.id))})}),e.jsx("div",{className:"  col-span-1",children:e.jsx(h,{labelPlacement:"outside",label:"Client Name",className:" ",startContent:"👤",...l("client"),children:w.map(s=>e.jsx(p,{value:s.id,children:s.company_name},s.id))})})]}),e.jsxs("div",{className:" flex justify-center space-x-5 items-center mt-8 ",children:[e.jsx("div",{className:" flex-1  ",children:e.jsx(o,{style:{border:"none",outline:"none",boxShadow:"none"},type:"date",label:"Delivery Note Date",labelPlacement:"outside",startContent:"🗓️",...l("date")},"date")}),e.jsx("div",{className:"flex-1  ",children:e.jsx(o,{style:{border:"none",outline:"none",boxShadow:"none"},type:"date",label:"Issue Date",labelPlacement:"outside",startContent:"🗓️",...l("issue_date")},"date")})]}),e.jsx(o,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",label:"Number",labelPlacement:"outside",className:"my-4 py-4",startContent:"🗓️",...l("number")},"date"),e.jsx("h2",{className:" font-medium text-gray-500 mt-10 ",children:"Item List"}),e.jsx(x,{className:"my-5"}),b.map(({id:s},a)=>e.jsx("div",{className:" border-b pb-2 border-gray-300 mb-4 ",children:e.jsx(L,{handleRemove:v,getValues:j,control:n.control,index:a,name:`items.${a}.name`,register:l},a)},a)),e.jsx("div",{className:"flex flex-col   items-end",children:e.jsx("input",{type:"hidden",...l("issued_by",{value:i.user.id})})})]})}),e.jsxs("div",{className:"sticky space-y-4",children:[e.jsx(c,{onClick:()=>{N()},className:"  w-full mt-4",color:"primary",endContent:e.jsx(V,{}),children:"Add New Item"}),e.jsxs("div",{className:" flex  justify-between",children:[e.jsx("div",{children:e.jsx(c,{onClick:()=>{d()},className:"  ",color:"primary",children:"Discard"})}),e.jsx("div",{children:e.jsx(c,{className:"  ",color:"primary",type:"submit",isLoading:g,children:"Submit"})})]})]})]})]},"createDeliverynote-sidebar")})}export{X as default};
