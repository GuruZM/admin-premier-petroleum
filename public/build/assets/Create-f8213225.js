import{u as $,R as A,r as T,f as q,b as D,j as e,c as O,y as R}from"./app-c6087f0f.js";import{A as F,d as f,a as y}from"./AuthenticatedLayout-afe5c58b.js";import{I as V}from"./InvoiceField-e1ee81cd.js";import{P as E}from"./PlusIcon-211e9922.js";import{u as L,a as B}from"./index.esm-09f4ff57.js";import{m as Q,b as u}from"./chunk-NXTXE2B3-1ea126da.js";import{i as m}from"./chunk-TC4QW7OA-15a4c771.js";import{s as z,l as G}from"./chunk-ZFWMN6TD-ffc2398d.js";import"./transition-6bafa127.js";import"./import-b46059d2.js";function ae({auth:x}){const h=$(),v=[{description:"",quantity:0,rate:0,amount:0}],d=L({defaultValues:{invoiceNumber:0,client:0,date:new Date().toISOString().slice(0,10),due_date:new Date().toISOString().slice(0,10),truck_plate:"",subtotal:0,invoicetotal:0,items:v,vat:0}}),{fields:j,append:N,remove:g}=B({control:d.control,name:"items"}),{register:a,reset:b,setValue:n,getValues:l,handleSubmit:H}=d,S=(t,s)=>{const o=parseInt(s.target.value);n(`items.${t}.rate`,o);const i=l(`items.${t}.quantity`),r=l(`items.${t}.rate`),c=i*r;n(`items.${t}.amount`,c),p()},w=(t,s)=>{const o=parseInt(s.target.value);n(`items.${t}.quantity`,o);const i=l(`items.${t}.quantity`),r=l(`items.${t}.rate`),c=i*r;n(`items.${t}.amount`,c),p()},p=()=>{const s=l("items").reduce((r,c)=>r+c.amount,0);n("subtotal",s);const o=l("subtotal")+l("subtotal")*.16,i=l("subtotal")*.16;n("vat",i),n("invoicetotal",o)},I=t=>{g(t)},C=()=>{N({description:"",quantity:0,rate:0,amount:0,id:""})},[_,J]=A.useState(!1),k=async t=>{O.post("/invoices",t).then(s=>{y.success("Invoice Added Successfully"),R.visit("/invoices"),b()}).catch(s=>{console.log("err :",s),y.error("Failed to create an Invoice")})};T.useEffect(()=>{h(q())},[h]);const P=D(t=>t.customers.customers);return e.jsx(F,{user:x.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Create Invoice"}),children:e.jsxs(Q.div,{initial:{x:-500,opacity:0},animate:{opacity:1,x:0,transition:{type:"spring",stiffness:300,damping:40,duration:.4}},exit:{x:-700,transition:{duration:.2}},className:"  scrollbar-hide flex flex-col dark:text-white dark:bg-[#141625] bg-white my-5  md:pl-[50px] py-16 px-6 h-screen md:w-full md:rounded-r-3xl",children:[e.jsx("h1",{className:" font-semibold dark:text-white  text-3xl",children:"Create Invoice"}),e.jsxs("form",{className:"overflow-y-scroll relative scrollbar-hide ",onSubmit:d.handleSubmit(k),children:[e.jsx("div",{className:"  ",children:e.jsxs("div",{className:" ",children:[e.jsx("h1",{className:"my-4 mt-5 font-medium",children:"Bill To"}),e.jsx(f,{className:"my-5"}),e.jsxs("div",{className:" grid grid-cols-2   gap-3   ",children:[e.jsx("div",{className:" mx-1 col-span-1 ",children:e.jsx(m,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",label:"Invoice No#",labelPlacement:"outside",startContent:"#",className:" ",...a("invoiceNumber")},"invoiceNumber")}),e.jsx("div",{className:"  col-span-1",children:e.jsx(z,{labelPlacement:"outside",label:"Client Name",className:" ",startContent:"ðŸ‘¤",...a("client"),children:P.map(t=>e.jsx(G,{value:t.id,children:t.company_name},t.id))})})]}),e.jsxs("div",{className:" flex justify-center space-x-5 items-center mt-8 ",children:[e.jsx("div",{className:" flex-1  ",children:e.jsx(m,{style:{border:"none",outline:"none",boxShadow:"none"},type:"date",label:"Invoice Date",labelPlacement:"outside",startContent:"ðŸ—“ï¸",...a("date")},"date")}),e.jsx("div",{className:"flex-1  ",children:e.jsx(m,{style:{border:"none",outline:"none",boxShadow:"none"},type:"date",label:"Due Date",labelPlacement:"outside",startContent:"ðŸ—“ï¸",...a("due_date")},"date")})]}),e.jsx("div",{className:" mx-1 mt-6 flex flex-col ",children:e.jsx(m,{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",label:"Truck Plate Number",labelPlacement:"outside",startContent:"ðŸšš",className:"",...a("truck_plate")},"transport")}),e.jsx("h2",{className:" font-medium text-gray-500 mt-10 ",children:"Item List"}),e.jsx(f,{className:"my-5"}),j.map(({id:t},s)=>e.jsx("div",{className:" border-b pb-2 border-gray-300 mb-4 ",children:e.jsx(V,{handleRemove:I,handlePriceChange:S,getValues:l,control:d.control,handleQuantityChange:w,index:s,name:`items.${s}.name`,register:a},s)},s)),e.jsxs("div",{className:"flex flex-col text-left   items-end",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm float-left",children:"Sub Total"}),e.jsx("input",{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",readOnly:!0,className:"bg-gray-100  mt-1 p-2 rounded-xl w-fit float-right",...a("subtotal")},"Sub Total")]}),e.jsxs("div",{className:"flex my-3 flex-col",children:[e.jsx("span",{className:"text-sm text-left",children:"VAT (16%)"}),e.jsx("input",{style:{border:"none",outline:"none",boxShadow:"none"},type:"text",readOnly:!0,className:" bg-gray-100 w-fit mt-1 p-2 rounded-xl  float-right",...a("vat")},"vat")]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:"Invoice Total"}),e.jsx("input",{style:{border:"none",outline:"none",boxShadow:"none"},isReadOnly:!0,readOnly:!0,className:"bg-gray-100 w-fit mt-1 p-2 rounded-xl float-right",...a("invoicetotal")},"invoiceTotal")]}),e.jsx("input",{type:"hidden",...a("issued_by",{value:x.user.id})})]})]})}),e.jsxs("div",{className:"sticky space-y-4",children:[e.jsx(u,{onClick:()=>{C()},className:"  w-full mt-4",color:"primary",endContent:e.jsx(E,{}),children:"Add New Item"}),e.jsxs("div",{className:" flex  justify-between",children:[e.jsx("div",{children:e.jsx(u,{onClick:()=>{b()},className:"  ",color:"primary",children:"Discard"})}),e.jsx("div",{children:e.jsx(u,{className:"  ",color:"primary",type:"submit",isLoading:_,children:"Submit"})})]})]})]})]},"createInvoice-sidebar")})}export{ae as default};
