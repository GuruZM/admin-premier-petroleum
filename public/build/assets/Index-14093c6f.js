import{R,u as N,b as L,r as O,f as p,j as e,c as f}from"./app-5602ef07.js";import{A as _,d as D,a as o}from"./AuthenticatedLayout-9d092e7a.js";import{u as v,C as w,a as U,A as F}from"./AddModal-6e949cbb.js";import"./TextInput-1ba0fa20.js";import{u as T}from"./index.esm-abcc67b5.js";import{I as a}from"./InputText-b9c27cc7.js";import{b as h}from"./chunk-NXTXE2B3-35aac85c.js";import"./methods-a1c28160.js";const V=["firstname","tpin","lastname","company_name","contact","address","actions"];function K({auth:j}){const[n,i]=R.useState(null),{register:s,reset:l,setValue:C,handleSubmit:y,getValues:M,formState:b}=T(),u=N(),{customers:g,status:W,error:$}=L(t=>t.customers);O.useEffect(()=>{u(p())},[]);const{isOpen:S,onOpen:x,onOpenChange:m}=v(),A=async t=>{try{n?(await f.put(`/customers/${n}`,t),o.success("Customer Updated Successfully"),l(),i(null)):(await f.post("/customers",t),o.success("Customer Added Successfully")),m(),u(p()),l()}catch(r){console.error("Error:",r),o.error("Failed to Add/Update Customer")}},E=t=>{i(t.id),Object.entries(t).forEach(([r,c])=>{C(r,c)}),x()},I=async t=>{var r,c;try{if(confirm("are you sure you want to delete this Record")){const d=await f.delete(`/customers/${t}`);o.success("Record Deleted"),u(p())}else o.error("Request Cancelled")}catch(d){o("Somthing Went Wrong"),console.error("Error deleting:",((c=(r=d.response)==null?void 0:r.data)==null?void 0:c.error)||d.message)}};return e.jsxs(_,{user:j.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Customers"}),children:[e.jsx(w,{baseurl:"none",editRecord:E,canEdit:!0,canDelete:!0,onOpen:x,title:n?"Edit Customer":"Add Customer",handleDelete:I,tableObject:g,tableColumns:U,initialColumns:V}),e.jsx(F,{onOpenChange:m,isOpen:S,title:"Add Customer",isSubmitting:!1,children:e.jsxs("form",{onSubmit:y(A),children:[e.jsxs("div",{className:"flex flex-col space-y-8",children:[e.jsx(a,{style:{border:"none",outline:"none",":focus":{outline:"none"}},title:"Firstname",name:"firstname",register:s}),e.jsx(a,{name:"lastname",register:s,title:"Lastname"}),e.jsx(a,{name:"company_name",register:s,title:"Company Name"}),e.jsx(a,{name:"tpin",register:s,title:"Tpin"}),e.jsx(a,{name:"contact",register:s,title:"Contact"}),e.jsx(a,{name:"address",register:s,title:"Address"})]}),e.jsx(D,{className:"my-5"}),e.jsxs("div",{className:"buttonSection flex  justify-end gap-1",children:[e.jsx(h,{color:"danger",variant:"flat",onPress:()=>{l(),i(null),m()},children:"Close"}),e.jsx(h,{isLoading:b.isSubmitting,type:"submit",color:"primary",children:n?"Update":"Create"})]})]})})]})}export{K as default};
